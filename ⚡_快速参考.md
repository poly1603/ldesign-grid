# ⚡ Grid 库快速参考

> @ldesign/grid v2.0 - 一分钟上手指南

---

## 🚀 快速开始

### 安装
```bash
pnpm add @ldesign/grid
```

### Vue 3 基础用法
```vue
<script setup>
import { GridStack, GridItem, GridDragSource } from '@ldesign/grid/vue'
</script>

<template>
  <!-- 拖拽源 -->
  <GridDragSource :data="{ name: '组件' }" :item-options="{ w: 4, h: 3 }">
    拖我
  </GridDragSource>

  <!-- Grid -->
  <GridStack>
    <GridItem :id="'1'" :x="0" :y="0" :w="4" :h="3">内容</GridItem>
  </GridStack>
</template>
```

### React 基础用法
```tsx
import { GridStack, GridItem, GridDragSource } from '@ldesign/grid/react'

<GridDragSource data={{ name: '组件' }} itemOptions={{ w: 4, h: 3 }}>
  拖我
</GridDragSource>

<GridStack>
  <GridItem id="1" x={0} y={0} w={4} h={3}>内容</GridItem>
</GridStack>
```

---

## 🎯 核心 API

### GridStack 组件
```vue
<GridStack 
  :options="{
    column: 12,           // 列数
    cellHeight: 70,       // 单元格高度
    acceptWidgets: true,  // 接受外部拖拽
    animate: true         // 启用动画
  }"
  @dropped="handleDropped"
  @change="handleChange"
/>
```

### GridItem 组件
```vue
<GridItem
  id="item-1"           // 唯一标识
  :x="0"                // X 位置
  :y="0"                // Y 位置
  :w="4"                // 宽度
  :h="3"                // 高度
  :locked="false"       // 是否锁定
  :no-resize="false"    // 禁止调整大小
  :no-move="false"      // 禁止移动
>
  内容
</GridItem>
```

### GridDragSource 组件
```vue
<GridDragSource
  :data="widget"                    // 传递的数据
  :item-options="{ w: 4, h: 3 }"   // Grid 项配置
  :disabled="false"                 // 是否禁用
  @dragstart="handleStart"          // 开始拖拽
  @dragend="handleEnd"              // 结束拖拽
  @dropped="handleDropped"          // 成功放置
>
  拖拽我
</GridDragSource>
```

---

## ⌨️ 键盘快捷键

### 导航
- `↑↓←→` - 移动焦点
- `Tab` - 下一项
- `Shift+Tab` - 上一项
- `Home` - 第一项
- `End` - 最后一项

### 操作
- `Delete` - 删除
- `Ctrl+C` - 复制
- `Ctrl+X` - 剪切
- `Ctrl+V` - 粘贴
- `Ctrl+A` - 全选
- `Ctrl+Z` - 撤销
- `Ctrl+Y` - 重做
- `Esc` - 取消选择

---

## 🎨 自动布局

```javascript
const layoutEngine = grid.getLayoutEngine()

layoutEngine.autoLayout('compact')   // 紧凑布局
layoutEngine.autoLayout('flow')      // 流式布局
layoutEngine.autoLayout('grid')      // 网格布局
layoutEngine.autoLayout('masonry')   // 瀑布流
layoutEngine.autoLayout('columns')   // 列布局
```

---

## 🎬 动画效果

```javascript
const animation = grid.getAnimationManager()

// 添加项目动画
await animation.animateAdd(item, 'fade')
await animation.animateAdd(item, 'slide')
await animation.animateAdd(item, 'scale')

// 特效
await animation.pulse(item, 3)      // 脉动
await animation.shake(item)         // 震动
await animation.flash(item)         // 闪烁
```

---

## 💾 保存和加载

```javascript
// 保存布局
const layout = grid.save()
localStorage.setItem('layout', JSON.stringify(layout))

// 加载布局
const layout = JSON.parse(localStorage.getItem('layout'))
grid.load(layout)

// IndexedDB 保存（推荐）
import { saveToIndexedDB, loadFromIndexedDB } from '@ldesign/grid'

await saveToIndexedDB('mydb', 'layouts', 'dashboard', layout)
const layout = await loadFromIndexedDB('mydb', 'layouts', 'dashboard')
```

---

## 📊 导出

```javascript
import { 
  downloadAsImage,
  downloadAsSVG,
  downloadAsCSV,
  downloadAsJSON 
} from '@ldesign/grid'

// 导出为图片
await downloadAsImage(grid, 'my-grid', { format: 'png' })

// 导出为 SVG
downloadAsSVG(grid, 'my-grid')

// 导出为 CSV
downloadAsCSV(grid, 'my-grid')

// 导出为 JSON
downloadAsJSON(grid, 'my-grid')
```

---

## 🎯 多选操作

```javascript
const selection = grid.getSelectionManager()

// 选择
selection.select(item)
selection.selectAll()

// 获取选中
const selected = selection.getSelectedItems()

// 批量操作
selection.updateSelected({ w: 6 })
selection.removeSelected()
selection.duplicateSelected()

// 对齐
selection.alignSelected('left')
selection.alignSelected('center')
selection.distributeSelected('horizontal')
```

---

## ⏮️ 撤销/重做

```javascript
const history = grid.getHistoryManager()

// 撤销/重做
history.undo()
history.redo()

// 检查状态
history.canUndo()
history.canRedo()

// 创建检查点
history.createCheckpoint('重要节点')
```

---

## ♿ 无障碍

```javascript
const a11y = grid.getAccessibilityManager()

// 启用高对比度
a11y.enableHighContrast()

// 自定义公告
a11y.announce('操作成功', 'polite')

// 验证无障碍
const issues = a11y.validate()
```

---

## 📱 触摸支持

触摸设备自动支持，无需额外配置！

- ✅ 触摸拖拽
- ✅ 多点触控检测
- ✅ 移动端优化
- ✅ 自动适配

---

## ⚡ 性能优化

### 自动优化
```javascript
// 大型网格自动启用虚拟滚动（50+ 项）
const grid = manager.create(container, {
  performance: {
    virtualScroll: true,
    batchUpdate: true,
    lazyRender: true
  }
})
```

### 批量操作
```javascript
const batch = grid.getBatchUpdateManager()

// 批量添加
batch.batch(() => {
  for (let i = 0; i < 100; i++) {
    grid.addItem(element, options)
  }
})
```

---

## 🎨 预设布局

```javascript
import { getPreset } from '@ldesign/grid/presets'

// 加载预设
const dashboardLayout = getPreset('dashboard')
const kanbanLayout = getPreset('kanban')
const blogLayout = getPreset('blog')

grid.load(dashboardLayout)
```

可用预设：
- `dashboard` - 仪表盘
- `kanban` - 看板
- `blog` - 博客
- `analytics` - 分析
- `portfolio` - 作品集
- `admin` - 管理面板
- `gallery` - 画廊
- `empty` - 空白

---

## 🔧 常用配置

### 基础配置
```javascript
{
  column: 12,              // 12 列网格
  cellHeight: 70,          // 单元格 70px
  acceptWidgets: true,     // 接受外部拖拽
  float: true,             // 浮动模式
  animate: true,           // 动画效果
  disableResize: false,    // 允许调整大小
  disableDrag: false       // 允许拖拽
}
```

### 性能配置
```javascript
{
  performance: {
    virtualScroll: true,   // 虚拟滚动（50+ 项自动启用）
    batchUpdate: true,     // 批量更新
    lazyRender: false      // 延迟渲染
  }
}
```

### 嵌套配置
```javascript
{
  nested: {
    enabled: true,         // 启用嵌套
    maxDepth: 3           // 最大嵌套深度
  }
}
```

---

## 🎯 事件监听

### Vue
```vue
<GridStack
  @added="handleAdded"
  @removed="handleRemoved"
  @change="handleChange"
  @dragstart="handleDragStart"
  @dragstop="handleDragStop"
  @dropped="handleDropped"
/>
```

### React
```tsx
<GridStack
  onAdded={handleAdded}
  onRemoved={handleRemoved}
  onChange={handleChange}
  onDragStart={handleDragStart}
  onDragStop={handleDragStop}
  onDropped={handleDropped}
/>
```

---

## 📖 文档快速链接

- 📘 [完整中文文档](docs/zh-CN/README.md)
- ⭐ [外部拖拽指南](docs/guide/external-drag.md)
- 🎯 [功能总结](FEATURE_SUMMARY.md)
- 📋 [变更日志](CHANGELOG.md)
- 🎊 [完成报告](FINAL_COMPLETION_REPORT.md)

---

## 💡 实用技巧

### 1. 调试模式
```javascript
import { logger } from '@ldesign/grid'

logger.configure({ level: LogLevel.DEBUG })
```

### 2. 性能监控
```javascript
const stats = grid.getStats()
console.log(stats.fps, stats.itemCount, stats.memoryUsage)
```

### 3. 获取管理器
```javascript
const history = grid.getHistoryManager()
const selection = grid.getSelectionManager()
const keyboard = grid.getKeyboardManager()
const layout = grid.getLayoutEngine()
const animation = grid.getAnimationManager()
```

---

**🎉 享受使用 @ldesign/grid v2.0！**

